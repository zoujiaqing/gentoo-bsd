diff -ur ../src.orig/sys/netinet6/in6.h ./sys/netinet6/in6.h
--- ../src.orig/sys/netinet6/in6.h	2007-07-19 11:16:40.000000000 +0200
+++ ./sys/netinet6/in6.h	2008-03-14 14:18:56.154967177 +0100
@@ -599,7 +599,8 @@
 /* New entries should be added here from current IPV6CTL_MAXID value. */
 /* to define items, should talk with KAME guys first, for *BSD compatibility */
 #define IPV6CTL_STEALTH		45
-#define IPV6CTL_MAXID		46
+#define IPV6CTL_RTHDR0_ALLOWED  46
+#define IPV6CTL_MAXID		47
 #endif /* __BSD_VISIBLE */
 
 /*
Only in ./sys/netinet6: in6.h~
diff -ur ../src.orig/sys/netinet6/in6_proto.c ./sys/netinet6/in6_proto.c
--- ../src.orig/sys/netinet6/in6_proto.c	2007-07-05 18:29:39.000000000 +0200
+++ ./sys/netinet6/in6_proto.c	2008-03-14 14:18:56.155966466 +0100
@@ -392,6 +392,8 @@
 #ifdef IPSTEALTH
 int	ip6stealth = 0;
 #endif
+int     ip6_rthdr0_allowed = 0; /* Disallow use of routing header 0 */
+				/* by default. */
 
 /* icmp6 */
 /*
@@ -539,6 +541,9 @@
 SYSCTL_INT(_net_inet6_ip6, IPV6CTL_STEALTH, stealth, CTLFLAG_RW,
 	&ip6stealth, 0, "");
 #endif
+SYSCTL_INT(_net_inet6_ip6, IPV6CTL_RTHDR0_ALLOWED, 
+	   rthdr0_allowed, CTLFLAG_RW, &ip6_rthdr0_allowed, 0, "");
+
 
 /* net.inet6.icmp6 */
 SYSCTL_INT(_net_inet6_icmp6, ICMPV6CTL_REDIRACCEPT,
Only in ./sys/netinet6: in6_proto.c~
diff -ur ../src.orig/sys/netinet6/route6.c ./sys/netinet6/route6.c
--- ../src.orig/sys/netinet6/route6.c	2007-07-05 18:23:48.000000000 +0200
+++ ./sys/netinet6/route6.c	2008-03-14 14:20:16.320778474 +0100
@@ -49,6 +49,8 @@
 
 #include <netinet/icmp6.h>
 
+extern int ip6_rthdr0_allowed;
+
 #if 0
 static int ip6_rthdr0 __P((struct mbuf *, struct ip6_hdr *,
     struct ip6_rthdr0 *));
@@ -94,6 +96,8 @@
 	switch (rh->ip6r_type) {
 #if 0
 	case IPV6_RTHDR_TYPE_0:
+		if (!ip6_rthdr0_allowed)
+			return (IPPROTO_DONE);
 		rhlen = (rh->ip6r_len + 1) << 3;
 #ifndef PULLDOWN_TEST
 		/*
Only in ./sys/netinet6: route6.c.rej
Only in ./sys/netinet6: route6.c~
